# 20 Newsgroups Classification

## Repository Structure

### ðŸ”¹ Main Training / Testing
- **`train.py`**  
  Trains the model and saves the best checkpoint.
- **`test.py`**  
  Evaluates the best model and saves metrics and plots.
- **`model.py`**  
  BiLSTM encoder with:
  - Word attention
  - Top-K attention
  - Cross-attention
  - Classification layer
- **`data_pipeline.py`**  
  Dataset loading, sentence splitting, tokenization, vocabulary construction, and GloVe embedding loading.
- **`config.py`**  
  All hyperparameters and file paths.
- **`best_model_by_val_loss.pt`**  
  Saved checkpoint based on best validation loss.

---

### ðŸ”¹ Analysis  
*(Generated outputs saved to `attention_reports/`)*

- **`analysis-1.py`**  
  Attention visualization:
  - Top-K words
  - Cross-attention heatmaps
  - Sentence importance
- **`analysis-2.py`**  
  Error analysis:
  - Per-class metrics
  - Confusion matrix
  - Misclassified examples and plots
- **`analysis-3.py`**  
  Attention behavior analysis:
  - Top-K sensitivity
  - Entropy and statistics plots
- **`analysis-4.py`**  
  Failure-mode analysis:
  - Biases
  - Compounding error patterns

---

### ðŸ”¹ Outputs
- **`attention_reports/`**
  - JSON summaries
  - CSV files
  - Visualization plots
- **Evaluation files**
  - `test_metrics.csv`
  - `confusion_matrix_test.csv`
  - Various `.png` plots generated by `test.py`
